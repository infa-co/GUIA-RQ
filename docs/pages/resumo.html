<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://cdn.tailwindcss.com"></script>
  <script>window.FontAwesomeConfig = { autoReplaceSvg: 'nest' };</script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js" crossorigin="anonymous"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>::-webkit-scrollbar { display: none; }</style>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: { inter: ['Inter', 'sans-serif'] },
          colors: {
            'primary-blue': '#2563eb',
            'secondary-green': '#10b981',
            'light-bg': '#f9fafb'
          }
        }
      }
    }
  </script>
</head>

<body class="font-inter bg-light-bg min-h-screen">

  <!-- HEADER -->
  <header id="header" class="bg-white shadow-sm border-b border-gray-100 sticky top-0 z-50">
    <div class="px-4 py-3">
      <div class="flex items-center justify-between">
        <button onclick="window.location.href='../index.html'" class="p-2 -ml-2 rounded-lg hover:bg-gray-50 transition-colors">
          <i class="fa-solid fa-arrow-left text-gray-600 text-lg"></i>
        </button>
        <h1 class="text-lg font-semibold text-gray-900">Guia RQ</h1>
        <div class="w-8"></div>
      </div>
    </div>

    <!-- Etapas -->
    <div class="px-4 pb-4">
      <div class="flex items-center justify-between">
        <div class="flex items-center">
          <div class="w-6 h-6 bg-primary-blue rounded-full flex items-center justify-center">
            <span class="text-white text-xs font-medium">1</span>
          </div>
          <span class="ml-2 text-sm font-medium text-primary-blue">Revisar</span>
        </div>
        <div class="flex-1 h-0.5 bg-gray-200 mx-3"></div>
        <div class="flex items-center">
          <div class="w-6 h-6 bg-gray-200 rounded-full flex items-center justify-center">
            <span class="text-gray-500 text-xs font-medium">2</span>
          </div>
          <span class="ml-2 text-sm text-gray-500">Pagamento</span>
        </div>
        <div class="flex-1 h-0.5 bg-gray-200 mx-3"></div>
        <div class="flex items-center">
          <div class="w-6 h-6 bg-gray-200 rounded-full flex items-center justify-center">
            <span class="text-gray-500 text-xs font-medium">3</span>
          </div>
          <span class="ml-2 text-sm text-gray-500">Confirma√ß√£o</span>
        </div>
      </div>
    </div>
  </header>

  <!-- CONTE√öDO PRINCIPAL -->
  <main id="main-content" class="px-4 pb-28">
    <section id="order-summary" class="mt-6">
      <h2 class="text-xl font-semibold text-gray-900 mb-4">Resumo da Reserva</h2>

      <div class="bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden">
        <div class="p-4 flex space-x-4">
          <div class="w-20 h-20 rounded-lg overflow-hidden bg-gray-100">
            <img id="package-image" class="w-full h-full object-cover" src="../assets/images/entrada.jpeg" alt="Imagem do Pacote">
          </div>
          <div class="flex-1">
            <h3 id="package-title" class="font-semibold text-gray-900 text-base leading-tight">Pacote Explorador</h3>
            <p id="package-description" class="text-sm text-gray-600 mt-1">3 tickets - ideal para quem quer conhecer o essencial</p>
          </div>
        </div>

        <div class="mt-2 p-4 border-t border-gray-100">
          <div class="flex justify-between items-center mb-2">
            <span class="text-sm text-gray-600">Valor do pacote</span>
            <span id="package-price" class="text-sm font-medium text-gray-900">R$ 50,00</span>
          </div>
          <div class="bg-primary-blue/5 rounded-lg p-3">
            <div class="flex justify-between items-center">
              <span class="text-base font-semibold text-gray-900">Total</span>
              <span id="total-amount" class="text-xl font-bold text-primary-blue">R$ 50,00</span>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- UPSELLS -->
    <section id="upsell-section" class="mt-8">
      <h2 class="text-xl font-semibold text-gray-900 mb-4">Aproveite e leve junto com desconto</h2>

      <div class="space-y-3">
        <div class="bg-white rounded-xl shadow-sm border border-gray-100 p-4 upsell-item flex items-center justify-between gap-4">
  <div class="flex items-center gap-4 flex-1">
    <div class="w-16 h-16 rounded-lg overflow-hidden bg-gray-100 flex-shrink-0">
      <img class="w-full h-full object-cover" src="../assets/images/praca2.jpeg" alt="">
    </div>
    <div class="flex-1">
      <h3 class="font-semibold text-gray-900 text-sm leading-tight">Descubra Rancho Queimado em 3 dias</h3>
      <p class="text-xs text-gray-600 mt-1">Adicione por R$ 18</p>
      <span class="text-sm font-semibold text-secondary-green block mt-1">R$ 18,00</span>
    </div>
  </div>
  <button
    class="add-upsell bg-primary-blue text-white px-3 py-1.5 rounded-lg text-xs font-medium whitespace-nowrap self-center"
    data-price="18"
    data-name="Descubra Rancho Queimado em 3 dias"
  >
    Adicionar
  </button>
</div>
            </div>
          </div>
        </div>

        <div class="bg-white rounded-xl shadow-sm border border-gray-100 p-4 upsell-item">
          <div class="flex items-start space-x-4">
            <div class="w-16 h-16 rounded-lg overflow-hidden bg-gray-100">
              <img class="w-full h-full object-cover" src="../assets/images/praca.jpeg" alt="">
            </div>
            <div class="flex-1">
              <h3 class="font-semibold text-gray-900 text-sm leading-tight">Mapa de Rancho Queimado</h3>
              <p class="text-xs text-gray-600 mt-1">Leve por R$ 22,50</p>
              <div class="flex items-center justify-between mt-3">
                <span class="text-sm font-semibold text-secondary-green">R$ 22,50</span>
                <button
  class="add-upsell bg-primary-blue text-white px-3 py-1.5 rounded-lg text-xs font-medium"
  data-price="22,50"
  data-name="Mapa de Rancho Queimado"
>
  Adicionar
</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Itens adicionados -->
    <section id="added-items" class="mt-6 hidden">
      <h3 class="text-lg font-semibold text-gray-900 mb-3">Itens Adicionados</h3>
      <div id="added-items-list" class="space-y-2"></div>
    </section>
  </main>

  <!-- BOT√ÉO FIXO -->
  <div id="fixed-bottom" class="fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 p-4">
    <div class="flex items-center justify-between mb-3">
      <span class="text-sm font-medium text-gray-700">Total do pedido:</span>
      <span id="final-total" class="text-lg font-bold text-primary-blue">R$ 50,00</span>
    </div>
    <button id="go-to-payment" class="w-full bg-primary-blue text-white py-3 rounded-xl font-semibold text-base shadow-lg hover:bg-blue-700 transition-colors">
      Ir para o pagamento
    </button>
  </div>

  <script>
  // üîπ Vari√°veis globais
  let totalAmount = 50.00;
  let addedItems = [];

  // Detecta pacote via URL e atualiza a tela
  const params = new URLSearchParams(window.location.search);
  const pacote = params.get("pacote");

  if (pacote) {
  const pacotes = {
    "rancho-completo": {
      nome: "Pacote Completo Guia RQ",
      preco: 77.00,
      img: "../assets/images/entrada.jpeg",
      desc: "10 tickets v√°lidos nas principais experi√™ncias de Rancho Queimado ‚Äî com economia de mais de R$230!"
    }
  };

  const pacoteInfo = pacotes[pacote];
  if (pacoteInfo) {
    document.getElementById("package-title").textContent = pacoteInfo.nome;
    document.getElementById("package-price").textContent = `R$ ${pacoteInfo.preco.toFixed(2).replace('.', ',')}`;
    document.getElementById("total-amount").textContent = `R$ ${pacoteInfo.preco.toFixed(2).replace('.', ',')}`;
    document.getElementById("final-total").textContent = `R$ ${pacoteInfo.preco.toFixed(2).replace('.', ',')}`;
    document.getElementById("package-image").src = pacoteInfo.img;
    document.getElementById("package-description").textContent = pacoteInfo.desc;
    totalAmount = pacoteInfo.preco;
  }
}

  // Atualiza total na tela
  function updateTotal() {
    document.getElementById("total-amount").textContent = `R$ ${totalAmount.toFixed(2).replace('.', ',')}`;
    document.getElementById("final-total").textContent = `R$ ${totalAmount.toFixed(2).replace('.', ',')}`;
  }

  // Exibe upsells adicionados
  function showAddedItems() {
    const section = document.getElementById("added-items");
    const list = document.getElementById("added-items-list");

    if (addedItems.length > 0) {
      section.classList.remove("hidden");
      list.innerHTML = addedItems.map(item => `
        <div class="bg-secondary-green/5 rounded-lg p-3 flex justify-between items-center">
          <span class="text-sm font-medium text-gray-900">${item.name}</span>
          <span class="text-sm font-semibold text-secondary-green">R$ ${item.price.toFixed(2).replace('.', ',')}</span>
        </div>
      `).join('');
    } else {
      section.classList.add("hidden");
    }
  }

  // Bot√µes de upsell
  document.querySelectorAll(".add-upsell").forEach(btn => {
    btn.addEventListener("click", function() {
      const name = this.dataset.name;
      const price = parseFloat(this.dataset.price);
      addedItems.push({ name, price });
      totalAmount += price;
      updateTotal();
      showAddedItems();
      this.textContent = "Adicionado";
      this.disabled = true;
      this.classList.replace("bg-primary-blue", "bg-gray-400");
    });
  });

  // üîπ Clique no bot√£o "Ir para o pagamento"
  document.getElementById("go-to-payment").addEventListener("click", () => {
    // Monta carrinho
    const carrinho = [{
      id: Date.now(),
      nome: document.getElementById("package-title").textContent,
      preco: totalAmount - addedItems.reduce((acc, i) => acc + i.price, 0),
      qtd: 1,
      local: "Rancho Queimado",
      img: document.getElementById("package-image").getAttribute("src") // Caminho relativo
    }];

    // Monta upsells
const upsellsCatalogo = {};
const upsellsSelecionados = [];

addedItems.forEach((item, index) => {
  const id = `upsell-${index}`;

  // Captura a imagem do upsell correspondente
  const upsellElement = document.querySelectorAll(".upsell-item")[index];
  const img = upsellElement
    ? upsellElement.querySelector("img")?.getAttribute("src") || ""
    : "";

  // Salva no cat√°logo
  upsellsCatalogo[id] = {
    nome: item.name,
    preco: item.price,
    ativo: true,
    img: img
  };

  upsellsSelecionados.push(id);
});

    // Calcula resumo
    const subtotal = carrinho.reduce((acc, i) => acc + i.preco * i.qtd, 0);
    const taxa = 0;
    const totalUpsells = addedItems.reduce((acc, i) => acc + i.price, 0);
    const totalFinal = subtotal + totalUpsells + taxa;

    const resumoCompra = { subtotal, taxa, totalFinal };

    // Salva no localStorage
    localStorage.setItem("carrinho", JSON.stringify(carrinho));
    localStorage.setItem("upsells", JSON.stringify(upsellsCatalogo));
    localStorage.setItem("upsellsSelecionados", JSON.stringify(upsellsSelecionados));
    localStorage.setItem("resumoCompra", JSON.stringify(resumoCompra));

    // Redireciona
    window.location.href = "pagamento.html";
  });
</script>
</body>
</html>