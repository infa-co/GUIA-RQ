<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-PF2TSPV6');</script>
    <!-- End Google Tag Manager -->
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://cdn.tailwindcss.com"></script>
  <script>window.FontAwesomeConfig = { autoReplaceSvg: 'nest' };</script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js" crossorigin="anonymous"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>::-webkit-scrollbar { display: none; }</style>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: { inter: ['Inter', 'sans-serif'] },
          colors: {
            'primary-blue': '#2563eb',
            'secondary-green': '#10b981',
            'light-bg': '#f9fafb'
          }
        }
      }
    }
  </script>
</head>

<body class="font-inter bg-light-bg min-h-screen">
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PF2TSPV6"
                  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->

  <!-- HEADER -->
  <header id="header" class="bg-white shadow-sm border-b border-gray-100 sticky top-0 z-50">
    <div class="px-4 py-3">
      <div class="flex items-center justify-between">
        <button onclick="window.location.href='../index.html'" class="p-2 -ml-2 rounded-lg hover:bg-gray-50 transition-colors">
          <i class="fa-solid fa-arrow-left text-gray-600 text-lg"></i>
        </button>
        <h1 class="text-lg font-semibold text-gray-900">Guia RQ</h1>
        <div class="w-8"></div>
      </div>
    </div>

    <!-- Etapas -->
    <div class="px-4 pb-4">
      <div class="flex items-center justify-between">
        <div class="flex items-center">
          <div class="w-6 h-6 bg-primary-blue rounded-full flex items-center justify-center">
            <span class="text-white text-xs font-medium">1</span>
          </div>
          <span class="ml-2 text-sm font-medium text-primary-blue">Revisar</span>
        </div>
        <div class="flex-1 h-0.5 bg-gray-200 mx-3"></div>
        <div class="flex items-center">
          <div class="w-6 h-6 bg-gray-200 rounded-full flex items-center justify-center">
            <span class="text-gray-500 text-xs font-medium">2</span>
          </div>
          <span class="ml-2 text-sm text-gray-500">Pagamento</span>
        </div>
        <div class="flex-1 h-0.5 bg-gray-200 mx-3"></div>
        <div class="flex items-center">
          <div class="w-6 h-6 bg-gray-200 rounded-full flex items-center justify-center">
            <span class="text-gray-500 text-xs font-medium">3</span>
          </div>
          <span class="ml-2 text-sm text-gray-500">Confirma√ß√£o</span>
        </div>
      </div>
    </div>
  </header>

  <!-- CONTE√öDO PRINCIPAL -->
  <main id="main-content" class="px-4 pb-28">
    <section id="order-summary" class="mt-6">
      <h2 class="text-xl font-semibold text-gray-900 mb-4">Resumo da Reserva</h2>

      <div class="bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden">
        <div class="p-4 flex space-x-4">
          <div class="w-20 h-20 rounded-lg overflow-hidden bg-gray-100">
            <img id="package-image" class="w-full h-full object-cover" src="../assets/images/entrada.jpeg" alt="Imagem do Pacote">
          </div>
          <div class="flex-1">
            <h3 id="package-title" class="font-semibold text-gray-900 text-base leading-tight">Pacote Explorador</h3>
            <p id="package-description" class="text-sm text-gray-600 mt-1">3 tickets - ideal para quem quer conhecer o essencial</p>
          </div>
        </div>

        <div class="mt-2 p-4 border-t border-gray-100">
          <div class="flex justify-between items-center mb-2">
            <span class="text-sm text-gray-600">Valor do pacote</span>
            <span id="package-price" class="text-sm font-medium text-gray-900">R$ 77,00</span>
          </div>
          <div class="bg-primary-blue/5 rounded-lg p-3">
            <div class="flex justify-between items-center">
              <span class="text-base font-semibold text-gray-900">Total</span>
              <span id="total-amount" class="text-xl font-bold text-primary-blue">R$ 77,00</span>
            </div>
          </div>
        </div>
      </div>
    </section>

      <section class="space-y-6">

          <!-- T√çTULO -->
          <h3 class="text-xl font-bold text-gray-900"></h3>
          <p class="text-gray-700 text-sm"></p>

          <!-- CARD 1 ‚Äì VANTAGEM -->
          <div class="bg-green-50 border border-green-200 p-5 rounded-2xl shadow-sm">
              <h4 class="text-green-800 font-semibold flex items-center gap-2 mb-2">
                  üí° Por que esse pacote √© t√£o vantajoso?
              </h4>

              <p class="text-green-700 text-sm leading-relaxed">
                  Os estabelecimentos parceiros oferecem descontos exclusivos para incentivar mais pessoas a conhecerem a cidade ‚Äî o Guia RQ re√∫ne tudo em um s√≥ lugar para voc√™ economizar.
              </p>
          </div>

          <!-- CARD 2 ‚Äì LISTA + CARD DE USO (ESCONDIDO NO MOBILE) -->
          <div class="bg-white border border-gray-200 p-5 rounded-2xl shadow-sm">

              <h4 class="text-gray-900 font-semibold mb-3">O que voc√™ vai ter acesso:</h4>

              <div id="expansible"
                   class="max-h-0 overflow-hidden transition-all duration-500 md:max-h-none md:overflow-visible">

                  <!-- LISTA DE TICKETS -->
                  <ul id="ticket-list" class="ml-3 text-gray-700 text-sm space-y-1 mt-1">
                      <li>üçï Ticket Pizzaria Forno e Serra ‚Ä¢ Desconto de R$16</li>
                      <li>üèçÔ∏è Ticket RJ Off-Road ‚Ä¢ Desconto de R$25</li>
                      <li>üè° Ticket Chal√© Encantado ‚Ä¢ Desconto de R$50</li>
                      <li>‚òï Ticket Bergkafee Caf√© Colonial ‚Ä¢ Desconto de R$15</li>
                      <li>ü•ó Ticket Da Ro√ßa ‚Ä¢ R$10 off a cada R$50 gasto</li>
                      <li>üåø Ticket Espa√ßo Floresta ‚Ä¢ Desconto de R$50</li>
                      <li>üç∫ Ticket Bierhaus ‚Ä¢ 10% extra na compra</li>
                      <li>üåÑ Ticket Mirante Boa Vista ‚Ä¢ Desconto de R$30</li>
                      <li>üç∑ Ticket Goyah Vinhos ‚Ä¢ Desconto de R$14</li>
                      <li>ü™µ Ticket Atafona (finais de semana) ‚Ä¢ Desconto de R$10</li>
                  </ul>

                  <!-- CARD DE USO (AGORA DENTRO DO EXPANS√çVEL) -->
                  <div class="mt-4 bg-green-50 border border-blue-200 p-5 rounded-2xl shadow-sm">
                      <p class="text-green-800 font-semibold text-sm leading-relaxed">
                          Use quando quiser durante 12 meses. Voc√™ n√£o perde nada ‚Äî s√≥ economiza.
                      </p>
                  </div>

              </div>

              <!-- BOT√ÉO MOBILE -->
              <button id="toggle-btn"
                      class="mt-3 md:hidden text-blue-600 font-semibold text-sm">
                  Mostrar mais ‚ñº
              </button>

          </div>

      </section>

      <script>
          const btn = document.getElementById("toggle-btn");
          const expandable = document.getElementById("expansible");

          btn?.addEventListener("click", () => {
              const isClosed = expandable.classList.contains("max-h-0");

              if (isClosed) {
                  expandable.classList.remove("max-h-0");
                  expandable.classList.add("max-h-[900px]");
                  btn.textContent = "Mostrar menos ‚ñ≤";
              } else {
                  expandable.classList.add("max-h-0");
                  expandable.classList.remove("max-h-[900px]");
                  btn.textContent = "Mostrar mais ‚ñº";
              }
          });
      </script>







    <!-- Itens adicionados -->
    <section id="added-items" class="mt-6 hidden">
      <h3 class="text-lg font-semibold text-gray-900 mb-3">Itens Adicionados</h3>
      <div id="added-items-list" class="space-y-2"></div>
    </section>
  </main>

  <!-- BOT√ÉO FIXO -->
  <div id="fixed-bottom" class="fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 p-4">
    <div class="flex items-center justify-between mb-3">
      <span class="text-sm font-medium text-gray-700">Total do pedido:</span>
      <span id="final-total" class="text-lg font-bold text-primary-blue">R$ 77,00</span>
    </div>
    <button id="go-to-payment" class="w-full bg-primary-blue text-white py-3 rounded-xl font-semibold text-base shadow-lg hover:bg-blue-700 transition-colors">
      Ir para o pagamento
    </button>
  </div>

  <script>
  // üîπ Vari√°veis globais
  let totalAmount = 77.00;
  let addedItems = [];

  // Detecta pacote via URL e atualiza a tela
  const params = new URLSearchParams(window.location.search);
  const pacote = params.get("pacote");

  if (pacote) {
  const pacotes = {
    "rancho-completo": {
      nome: "Pacote Completo Guia RQ",
      preco: 77.00,
      img: "../assets/images/entrada.jpeg",
      desc: "10 tickets v√°lidos nas principais experi√™ncias de Rancho Queimado ‚Äî com economia de mais de R$230!"
    }
  };

  const pacoteInfo = pacotes[pacote];
  if (pacoteInfo) {
    document.getElementById("package-title").textContent = pacoteInfo.nome;
    document.getElementById("package-price").textContent = `R$ ${pacoteInfo.preco.toFixed(2).replace('.', ',')}`;
    document.getElementById("total-amount").textContent = `R$ ${pacoteInfo.preco.toFixed(2).replace('.', ',')}`;
    document.getElementById("final-total").textContent = `R$ ${pacoteInfo.preco.toFixed(2).replace('.', ',')}`;
    document.getElementById("package-image").src = pacoteInfo.img;
    document.getElementById("package-description").textContent = pacoteInfo.desc;
    totalAmount = pacoteInfo.preco;
  }
}

  // Atualiza total na tela
  function updateTotal() {
    document.getElementById("total-amount").textContent = `R$ ${totalAmount.toFixed(2).replace('.', ',')}`;
    document.getElementById("final-total").textContent = `R$ ${totalAmount.toFixed(2).replace('.', ',')}`;
  }

  // Exibe upsells adicionados
  function showAddedItems() {
    const section = document.getElementById("added-items");
    const list = document.getElementById("added-items-list");

    if (addedItems.length > 0) {
      section.classList.remove("hidden");
      list.innerHTML = addedItems.map(item => `
        <div class="bg-secondary-green/5 rounded-lg p-3 flex justify-between items-center">
          <span class="text-sm font-medium text-gray-900">${item.name}</span>
          <span class="text-sm font-semibold text-secondary-green">R$ ${item.price.toFixed(2).replace('.', ',')}</span>
        </div>
      `).join('');
    } else {
      section.classList.add("hidden");
    }
  }

  // Bot√µes de upsell
  document.querySelectorAll(".add-upsell").forEach(btn => {
    btn.addEventListener("click", function() {
      const name = this.dataset.name;
      const price = parseFloat(this.dataset.price);
      addedItems.push({ name, price });
      totalAmount += price;
      updateTotal();
      showAddedItems();
      this.textContent = "Adicionado";
      this.disabled = true;
      this.classList.replace("bg-primary-blue", "bg-gray-400");
    });
  });

  // Clique no bot√£o "Ir para o pagamento"
  document.getElementById("go-to-payment").addEventListener("click", () => {
    // Monta carrinho
    //Arrumar depois
    const nome = document.getElementById("package-title").textContent
    const carrinho = [{
      id: 11,
      nome: nome,
      preco: 77,
      qtd: 1,
      local: "Rancho Queimado",
      img: document.getElementById("package-image").getAttribute("src") // Caminho relativo
    }];

    // Monta upsells
const upsellsCatalogo = {};
const upsellsSelecionados = [];

addedItems.forEach((item, index) => {
  const id = `upsell-${index}`;

  // Captura a imagem do upsell correspondente
  const upsellElement = document.querySelectorAll(".upsell-item")[index];
  const img = upsellElement
    ? upsellElement.querySelector("img")?.getAttribute("src") || ""
    : "";

  // Salva no cat√°logo
  upsellsCatalogo[id] = {
    nome: item.name,
    preco: item.price,
    ativo: true,
    img: img
  };

  upsellsSelecionados.push(id);
});

    // Calcula resumo
    const subtotal = carrinho.reduce((acc, i) => acc + i.preco * i.qtd, 0);
    const taxa = 0;
    const totalUpsells = addedItems.reduce((acc, i) => acc + i.price, 0);
    const totalFinal = subtotal + totalUpsells + taxa;

    const resumoCompra = { subtotal, taxa, totalFinal };

    // Salva no localStorage
    localStorage.setItem("carrinho", JSON.stringify(carrinho));
    localStorage.setItem("upsells", JSON.stringify(upsellsCatalogo));
    localStorage.setItem("upsellsSelecionados", JSON.stringify(upsellsSelecionados));
    localStorage.setItem("resumoCompra", JSON.stringify(resumoCompra));

    // Redireciona
    window.location.href = "pagamento.html";
  });
</script>
</body>
</html>